
#include <cmath>
#include <cstdint>
#include <iostream>

#define restrict __restrict__

template <typename T, typename S, int P>
struct Operator
{
    constexpr static std::size_t num_dofs = (P + 1) * (P + 1) * (P + 1);
    inline void apply(T *restrict A, const T *restrict w, const T *restrict detJ)
    {
        constexpr int cubNq = (P + 2) * (P + 2) * (P + 2);
        constexpr int Nd = P + 1;
        constexpr int Nq = P + 2;

        T w0[Nq * Nq * Nq] = {0};
        {
#if OPTIMIZE_SUM_FACTORIZATION == 1
            T temp0[Nq * Nd * Nd] = {0};
            for (int iq0 = 0; iq0 < Nq; ++iq0)
                for (int ic0 = 0; ic0 < Nd; ++ic0)
                    for (int id = 0; id < Nd * Nd; ++id)
                        temp0[Nd * Nd * iq0 + id] += phi[iq0][ic0] * w[Nd * Nd * ic0 + id];
            T temp1[Nq * Nq * Nd] = {0};
            T temp0transp[Nq * Nd * Nd] = {0};
            for (int ic1 = 0; ic1 < Nd; ++ic1)
                for (int iq0 = 0; iq0 < Nq; ++iq0)
                    for (int ic2 = 0; ic2 < Nd; ++ic2)
                        temp0transp[Nq * Nd * ic1 + Nd * iq0 + ic2] = temp0[Nd * Nd * iq0 + Nd * ic1 + ic2];
            for (int iq1 = 0; iq1 < Nq; ++iq1)
                for (int ic1 = 0; ic1 < Nd; ++ic1)
                    for (int id = 0; id < Nq * Nd; ++id)
                        temp1[Nq * Nd * iq1 + id] += phi[iq1][ic1] * temp0transp[Nq * Nd * ic1 + id];
            T temp1transp[Nq * Nq * Nd] = {0};
            for (int ic2 = 0; ic2 < Nd; ++ic2)
                for (int iq1 = 0; iq1 < Nq; ++iq1)
                    for (int iq0 = 0; iq0 < Nq; ++iq0)
                        temp1transp[Nq * Nq * ic2 + Nq * iq1 + iq0] = temp1[Nq * Nd * iq1 + Nd * iq0 + ic2];
            for (int iq2 = 0; iq2 < Nq; ++iq2)
                for (int ic2 = 0; ic2 < Nd; ++ic2)
                    for (int id = 0; id < Nq * Nq; ++id)
                        w0[Nq * Nq * iq2 + id] += phi[iq2][ic2] * temp1transp[Nq * Nq * ic2 + id];
#else
            T temp0[cubNq] = {0};
            for (int iq0 = 0; iq0 < Nq; ++iq0)
                for (int ic0 = 0; ic0 < Nd; ++ic0)
                    for (int ic1 = 0; ic1 < Nd; ++ic1)
                        for (int ic2 = 0; ic2 < Nd; ++ic2)
                            temp0[Nd * Nd * iq0 + Nd * ic1 + ic2] += phi[iq0][ic0] * w[Nd * Nd * ic0 + Nd * ic1 + ic2];
            T temp1[Nq * Nq * Nd] = {0};
            for (int iq1 = 0; iq1 < Nq; ++iq1)
                for (int ic1 = 0; ic1 < Nd; ++ic1)
                    for (int iq0 = 0; iq0 < Nq; ++iq0)
                        for (int ic2 = 0; ic2 < Nd; ++ic2)
                            temp1[Nq * Nd * iq1 + Nd * iq0 + ic2] += phi[iq1][ic1] * temp0[Nd * Nd * iq0 + Nd * ic1 + ic2];
            for (int iq2 = 0; iq2 < Nq; ++iq2)
                for (int ic2 = 0; ic2 < Nd; ++ic2)
                    for (int iq1 = 0; iq1 < Nq; ++iq1)
                        for (int iq0 = 0; iq0 < Nq; ++iq0)
                            w0[Nq * Nq * iq0 + Nq * iq1 + iq2] += phi[iq2][ic2] * temp1[Nq * Nd * iq1 + Nd * iq0 + ic2];
#endif
        }
        T fw0[Nq * Nq * Nq] = {0};
        {
            for (int iq = 0; iq < cubNq; iq++)
                fw0[iq] = w0[iq] * detJ[iq];
        }
        {
#if OPTIMIZE_SUM_FACTORIZATION == 1
            T temp0[Nq * Nq * Nd] = {0};
            for (int iq0 = 0; iq0 < Nq; ++iq0)
                for (int i0 = 0; i0 < Nd; ++i0)
                    for (int id = 0; id < Nq * Nq; ++id)
                        temp0[Nq * Nq * i0 + id] += phi[iq0][i0] * fw0[Nq * Nq * iq0 + id];
            T temp1[Nq * Nd * Nd] = {0};
            T temp0transp[Nq * Nq * Nd] = {0};
            for (int iq1 = 0; iq1 < Nq; ++iq1)
                for (int i0 = 0; i0 < Nd; ++i0)
                    for (int iq2 = 0; iq2 < Nq; ++iq2)
                        temp0transp[Nq * Nd * iq1 + Nq * i0 + iq2] = temp0[Nq * Nq * i0 + Nq * iq1 + iq2];
            for (int iq1 = 0; iq1 < Nq; ++iq1)
                for (int i1 = 0; i1 < Nd; ++i1)
                    for (int id = 0; id < Nq * Nd; ++id)
                        temp1[Nq * Nd * i1 + id] += phi[iq1][i1] * temp0transp[Nq * Nd * iq1 + id];
            T temp1transp[Nq * Nd * Nd] = {0};
            for (int iq2 = 0; iq2 < Nq; ++iq2)
                for (int i1 = 0; i1 < Nd; ++i1)
                    for (int i0 = 0; i0 < Nd; ++i0)
                        temp1transp[Nd * Nd * iq2 + Nd * i1 + i0] = temp1[Nq * Nd * i1 + Nq * i0 + iq2];
            for (int iq2 = 0; iq2 < Nq; ++iq2)
                for (int i2 = 0; i2 < Nd; ++i2)
                    for (int id = 0; id < Nd * Nd; ++id)
                        A[Nd * Nd * i2 + id] += phi[iq2][i2] * temp1transp[Nd * Nd * iq2 + id];
#else
            T temp0[Nd*Nq*Nq] = {0};
            for (int iq0 = 0; iq0 < Nq; ++iq0)
                for (int i0 = 0; i0 < Nd; ++i0)
                    for (int iq1 = 0; iq1 < Nq; ++iq1)
                        for (int iq2 = 0; iq2 < Nq; ++iq2)
                            temp0[Nq*Nq * i0 + Nq * iq1 + iq2] += phi[iq0][i0] * fw0[Nq * Nq * iq0 + Nq *iq1 + iq2];
            T temp1[Nd*Nd*Nq] = {0};
            for (int iq1 = 0; iq1 < Nq; ++iq1)
                for (int i1 = 0; i1 < Nd; ++i1)
                    for (int i0 = 0; i0 < Nd; ++i0)
                        for (int iq2 = 0; iq2 < Nq; ++iq2)
                            temp1[Nq*Nd * i1 + Nq * i0 + iq2] += phi[iq1][i1] * temp0[Nq*Nq * i0 + Nq * iq1 + iq2];
            for (int iq2 = 0; iq2 < Nq; ++iq2)
                for (int i2 = 0; i2 < Nd; ++i2)
                    for (int i1 = 0; i1 < Nd; ++i1)
                        for (int i0 = 0; i0 < Nd; ++i0)
                            A[Nd*Nd * i0 + Nd * i1 + i2] += phi[iq2][i2] * temp1[Nq*Nd * i1 + Nq * i0 + iq2];
#endif
        }
    }
#if DEGREE == 1
    constexpr static S phi[3][2] = {{0.8872983346207417, 0.1127016653792582},
                                    {0.5, 0.5},
                                    {0.1127016653792582, 0.8872983346207417}};
#elif DEGREE == 2
    static constexpr S phi[4][3] =
        {{0.8013460293699309, -0.05979028222412172, 0.2584442528541908},
         {0.2277840767909521, -0.1121969667939042, 0.884412890002952},
         {-0.1121969667939042, 0.2277840767909522, 0.884412890002952},
         {-0.05979028222412186, 0.8013460293699308, 0.2584442528541911}};
#elif DEGREE == 3
    static constexpr S phi[5][4] =
        {{0.7400289499867195, 0.03642344149505652, 0.3382587987733498, -0.1147111902551258},
         {0.08649005029831017, 0.02594644710880264, 0.9781189357260486, -0.09055543313316139},
         {-0.125, -0.1249999999999999, 0.625, 0.625},
         {0.02594644710880267, 0.08649005029831018, -0.09055543313316142, 0.9781189357260485},
         {0.03642344149505655, 0.7400289499867192, -0.1147111902551258, 0.3382587987733502}};
#elif DEGREE == 4
    static constexpr S phi[6][5] =
        {{0.6952211757042368, -0.02429462580729091, 0.394314403846744, -0.1342631882800179, 0.06902223453632828},
         {0.008290910921566141, -0.001690866197093896, 0.9997474117778138, -0.01132826345325647, 0.004980806950970695},
         {-0.09610913838780928, 0.05907841153498624, 0.4104063461116276, 0.8177677602732188, -0.1911433795320231},
         {0.05907841153498634, -0.09610913838780918, -0.1911433795320233, 0.8177677602732185, 0.4104063461116277},
         {-0.001690866197094076, 0.008290910921566697, 0.004980806950970695, -0.0113282634532571, 0.9997474117778136},
         {-0.02429462580729096, 0.6952211757042368, 0.06902223453632836, -0.1342631882800181, 0.3943144038467438}};
#elif DEGREE == 5
    static constexpr S phi[7][6] =
        {{0.6613801132697966, 0.0172689333854408, 0.4357362309394597, -0.1462685224347597, 0.07866897648617358, -0.0467857316461103},
         {-0.03795409189277521, -0.005632944855822858, 0.9936129295815759, 0.06202307653341402, -0.02756343724074753, 0.01551446787435576},
         {-0.06468864365152199, -0.02733947706738125, 0.2549431027449786, 0.9193227088517443, -0.1604494243763332, 0.07821173349851357},
         {0.06249999999999993, 0.06249999999999992, -0.1946486423538423, 0.632148642353842, 0.6321486423538424, -0.1946486423538421},
         {-0.02733947706738132, -0.06468864365152197, 0.07821173349851369, -0.1604494243763335, 0.9193227088517444, 0.2549431027449787},
         {-0.005632944855822913, -0.03795409189277525, 0.0155144678743557, -0.02756343724074739, 0.06202307653341413, 0.9936129295815761},
         {0.01726893338544076, 0.6613801132697952, -0.04678573164611055, 0.07866897648617371, -0.1462685224347599, 0.4357362309394608}};
#elif DEGREE == 6
    static constexpr S phi[8][7] =
        {{0.6350438437625417, -0.01286426192666382, 0.4674709615755636, -0.154510224122982, 0.08403356797504669, -0.05313177191953894, 0.03395788465603247},
         {-0.06686280177625431, 0.007567041065257414, 0.9768280677763562, 0.1248776379178688, -0.05460934792907682, 0.03234816598450888, -0.02014876303866006},
         {-0.03850058335269051, 0.0119743631019733, 0.144552852360654, 0.9703754681309463, -0.1112306143208937, 0.05531519567788873, -0.03248668159787792},
         {0.05464946614535726, -0.03770792172037474, -0.1663516843701492, 0.4707874429368532, 0.7784764797450096, -0.2059984830313439, 0.1061447002946481},
         {-0.03770792172037446, 0.05464946614535705, 0.1061447002946475, -0.2059984830313424, 0.7784764797450094, 0.4707874429368515, -0.1663516843701483},
         {0.01197436310197338, -0.03850058335269049, -0.03248668159787796, 0.05531519567788848, -0.1112306143208938, 0.9703754681309467, 0.1445528523606538},
         {0.007567041065257379, -0.06686280177625462, -0.02014876303866034, 0.03234816598450879, -0.0546093479290771, 0.1248776379178693, 0.9768280677763564},
         {-0.0128642619266639, 0.6350438437625402, 0.03395788465603246, -0.05313177191953916, 0.08403356797504663, -0.1545102241229825, 0.4674709615755658}};
#elif DEGREE == 7
    static constexpr S phi[9][8] =
        {{0.6140199424134852, 0.009933260265880338, 0.4924933510874351, -0.1604972830785221, 0.08755063945380072, -0.05642552470063936, 0.03873475837799444, -0.02580914381943444},
         {-0.08576211976259915, -0.007659085815419249, 0.9565208064674119, 0.1778741554177261, -0.07625081278625181, 0.04571647336183521, -0.03044001166598273, 0.02000059478327983},
         {-0.0180120246598259, -0.004316404237264343, 0.06546846920862646, 0.9931316132781198, -0.05856886186586474, 0.02876734415527758, -0.0178598553650835, 0.01138971948601414},
         {0.0436650355422517, 0.02228160997219499, -0.1309060500845324, 0.3409688113100979, 0.8722924385549528, -0.1879358782544942, 0.09955853952912193, -0.05992450656959285},
         {-0.03906250000000019, -0.03906250000000029, 0.1088400233988095, -0.2040293534695563, 0.6342518300707476, 0.6342518300707466, -0.2040293534695567, 0.1088400233988098},
         {0.02228160997219484, 0.04366503554225151, -0.05992450656959242, 0.09955853952912128, -0.1879358782544933, 0.872292438554954, 0.3409688113100959, -0.1309060500845319},
         {-0.004316404237264204, -0.01801202465982554, 0.01138971948601389, -0.01785985536508321, 0.0287673441552769, -0.05856886186586351, 0.9931316132781203, 0.06546846920862531},
         {-0.007659085815419173, -0.08576211976259893, 0.0200005947832798, -0.03044001166598265, 0.04571647336183457, -0.07625081278625118, 0.177874155417726, 0.9565208064674113},
         {0.009933260265880317, 0.6140199424134852, -0.02580914381943414, 0.0387347583779943, -0.05642552470063923, 0.08755063945380062, -0.1604972830785227, 0.4924933510874354}};
#elif DEGREE == 8
    static constexpr S phi[10][9] =
        {{0.596875089941198, -0.007890213094280129, 0.5126924425292239, -0.1650141466731779, 0.09004967026397248, -0.05848438995251584, 0.0411371480177148, -0.02965492821020267, 0.02028932717806765},
         {-0.09857080589805133, 0.007131560743831047, 0.9357505619587623, 0.2225652749858448, -0.0935791999356399, 0.05623053061642991, -0.03824493497522768, 0.02711293575226469, -0.01839592324821358},
         {-0.002205690440727832, 0.0004210546753689384, 0.007833021632503073, 0.9998901407465383, -0.007895230803957917, 0.003806320760973814, -0.002395332772515385, 0.001638693309455042, -0.001092977107637852},
         {0.03269865783524842, -0.01292540091249444, -0.09696845469104837, 0.2389162059403344, 0.9309988151853471, -0.1563391192585775, 0.08214389660172591, -0.05244602424176316, 0.03392142354122774},
         {-0.03601277525360734, 0.02667950366965466, 0.09963726249715048, -0.1823949859960125, 0.5052443260261775, 0.7529607781243607, -0.2114196411430793, 0.1166517890299628, -0.07134625695460715},
         {0.0266795036696547, -0.03601277525360741, -0.0713462569546072, 0.1166517890299631, -0.2114196411430798, 0.7529607781243606, 0.5052443260261777, -0.1823949859960124, 0.0996372624971507},
         {-0.01292540091249437, 0.03269865783524833, 0.03392142354122773, -0.05244602424176315, 0.08214389660172618, -0.1563391192585774, 0.9309988151853482, 0.238916205940333, -0.09696845469104826},
         {0.0004210546753688829, -0.002205690440727479, -0.001092977107637644, 0.001638693309454847, -0.002395332772514733, 0.003806320760973203, -0.007895230803956849, 0.9998901407465378, 0.007833021632501797},
         {0.007131560743830929, -0.09857080589805108, -0.01839592324821329, 0.0271129357522648, -0.03824493497522741, 0.05623053061642957, -0.0935791999356394, 0.2225652749858434, 0.9357505619587624},
         {-0.007890213094280184, 0.5968750899411979, 0.02028932717806753, -0.02965492821020239, 0.04113714801771473, -0.05848438995251579, 0.09004967026397222, -0.1650141466731782, 0.512692442529224}};
#elif DEGREE == 9
    static constexpr S phi[11][10] =
        {{0.5826405846218515, 0.006412235154692098, 0.5293193413315839, -0.1685206358810894, 0.09191399229242322, -0.05990464866185732, 0.04258779348172199, -0.03157971174233706, 0.02350204699265676, -0.01637099758964634},
         {-0.1075076002732936, -0.00643414207961553, 0.9158160622682417, 0.2604710666836622, -0.1075813352045514, 0.06458150918470786, -0.04429538735066611, 0.0322461363684136, -0.02375695571432407, 0.01646064611742502},
         {0.01001933851287053, 0.001562694141591162, -0.03496639503890694, 0.9975806013086699, 0.03885939155851123, -0.01837577488952669, 0.01159216108849789, -0.008113216528039133, 0.005855298750923055, -0.004014098904591562},
         {0.02282479921992137, 0.007225700917735181, -0.06713690018139143, 0.1589534244195884, 0.9664988749272161, -0.1191035217311575, 0.06157569436368097, -0.03991078965475583, 0.02776004559114183, -0.01868732787197917},
         {-0.03113095451984767, -0.0179118123587542, 0.08568620574904798, -0.1541669449468101, 0.3956003338556896, 0.8373172960068398, -0.2007768552812596, 0.1102868558325793, -0.07174317540476927, 0.04683905106728412},
         {0.02734374999999979, 0.02734374999999988, -0.07283186257766797, 0.1177435823540573, -0.207409093657436, 0.6351536238810473, 0.6351536238810469, -0.2074090936574362, 0.1177435823540571, -0.07283186257766802},
         {-0.01791181235875409, -0.03113095451984762, 0.04683905106728392, -0.07174317540476918, 0.1102868558325787, -0.2007768552812583, 0.8373172960068397, 0.3956003338556887, -0.1541669449468092, 0.08568620574904762},
         {0.00722570091773508, 0.02282479921992123, -0.01868732787197905, 0.02776004559114169, -0.03991078965475574, 0.06157569436368068, -0.1191035217311572, 0.966498874927217, 0.158953424419587, -0.06713690018139075},
         {0.001562694141591176, 0.01001933851287072, -0.004014098904591729, 0.005855298750923096, -0.008113216528039105, 0.01159216108849795, -0.01837577488952696, 0.03885939155851161, 0.9975806013086698, -0.03496639503890711},
         {-0.006434142079615564, -0.1075076002732941, 0.01646064611742501, -0.02375695571432419, 0.03224613636841374, -0.04429538735066618, 0.06458150918470809, -0.1075813352045518, 0.2604710666836619, 0.9158160622682423},
         {0.006412235154692136, 0.5826405846218501, -0.01637099758964622, 0.02350204699265684, -0.03157971174233667, 0.04258779348172202, -0.05990464866185716, 0.09191399229242345, -0.168520635881089, 0.5293193413315855}};
#elif DEGREE == 10
    // Quadrature rules
    static constexpr S phi[12][11] =
        {{0.5706413675486156, -0.005310089788991574, 0.5432323091446105, -0.1713058767363311, 0.09335244998710379, -0.06094540759832984, 0.04356036538081666, -0.03272206891488498, 0.02512612419303156, -0.01911643974647504, 0.01348726653083455},
         {-0.1138913061191315, 0.00573505169900514, 0.8972236368539178, 0.2928711004002489, -0.1190232804839144, 0.07130201791199997, -0.04908012764556038, 0.03615144807351449, -0.02745075578689619, 0.02074929671849815, -0.01458708162168156},
         {0.01955628152534752, -0.002542426850523982, -0.06732920704635995, 0.9901838588982061, 0.08120795840052815, -0.03769796594249127, 0.02374988109501716, -0.01677295862264834, 0.01244861385294208, -0.009288343378366593, 0.006484308068349029},
         {0.01429408716697908, -0.003716276954937807, -0.04177820681955806, 0.0959931761486375, 0.9866669004245109, -0.0803665171628361, 0.04081296430147502, -0.02653412026689141, 0.01890428648783225, -0.01379685430145336, 0.009520560976242216},
         {-0.0257262705172236, 0.01188986938899425, 0.07052998976884796, -0.1252378397660309, 0.3043010250211501, 0.8963254201458998, -0.1796636354894567, 0.09735111034592608, -0.06437929795529905, 0.04528327278502485, -0.03067364372783309},
         {0.02590005678844663, -0.02013493753812413, -0.06878280309729454, 0.1102661093434948, -0.19018998119263, 0.5277598649859653, 0.7351434964093975, -0.2137717685775697, 0.121198762953117, -0.07990721200529298, 0.05251841193048966},
         {-0.02013493753812418, 0.02590005678844681, 0.0525184119304897, -0.07990721200529292, 0.1211987629531174, -0.2137717685775704, 0.7351434964093988, 0.5277598649859648, -0.1901899811926303, 0.1102661093434954, -0.06878280309729481},
         {0.01188986938899421, -0.02572627051722353, -0.03067364372783301, 0.04528327278502474, -0.06437929795529895, 0.09735111034592617, -0.1796636354894564, 0.8963254201459001, 0.3043010250211495, -0.1252378397660309, 0.070529989768848},
         {-0.003716276954937672, 0.0142940871669786, 0.009520560976241849, -0.01379685430145292, 0.0189042864878315, -0.02653412026689028, 0.04081296430147356, -0.08036651716283377, 0.9866669004245119, 0.09599317614863377, -0.04177820681955645},
         {-0.002542426850524023, 0.01955628152534771, 0.006484308068348932, -0.009288343378366579, 0.01244861385294252, -0.01677295862264834, 0.02374988109501733, -0.0376979659424916, 0.08120795840052863, 0.9901838588982063, -0.06732920704636028},
         {0.00573505169900514, -0.1138913061191313, -0.01458708162168149, 0.02074929671849783, -0.02745075578689608, 0.03615144807351421, -0.04908012764556018, 0.07130201791199943, -0.1190232804839139, 0.2928711004002483, 0.8972236368539181},
         {-0.005310089788991616, 0.5706413675486135, 0.01348726653083426, -0.01911643974647505, 0.02512612419303126, -0.03272206891488541, 0.04356036538081665, -0.06094540759833002, 0.09335244998710406, -0.1713058767363316, 0.5432323091446131}};
#elif DEGREE == 11
    // Quadrature rules
    static constexpr S phi[13][12] =
        {{0.5603940157942696, 0.004467189386972017, 0.5550380706348194, -0.1735606863857838, 0.09449078476625125, -0.06173986945895109, 0.04425789989901331, -0.03347294055047829, 0.02608656506663651, -0.02052816908315816, 0.01586992081183747, -0.01130278088142798},
         {-0.1185389261578727, -0.005093765865551339, 0.8801163156409336, 0.3207927813158072, -0.1284799245008396, 0.07678165229676046, -0.05292994029020866, 0.03921703520244069, -0.03020058412829528, 0.02359348151902566, -0.01815905056184321, 0.01290092552964312},
         {0.02707612017826167, 0.002982105238146099, -0.09221161897232083, 0.980027663689964, 0.1192658267404006, -0.05441845399828574, 0.03419157172246809, -0.02423782479325046, 0.01821548564483592, -0.01402650252534973, 0.01070278967253675, -0.007567162597406453},
         {0.007049059677191417, 0.001535057608834368, -0.02049807734414719, 0.04601024332640059, 0.9966763940054971, -0.04228202301888644, 0.02109577874451549, -0.01369898312358744, 0.009854158204943453, -0.007403946458944224, 0.005569534690765585, -0.003907196312583031},
         {-0.02042480902933792, -0.007776656272746967, 0.05582024278884258, -0.09809592768203712, 0.2287954811644296, 0.9369122012492654, -0.152833830380769, 0.08148928976598356, -0.0540939099738777, 0.03901174614838956, -0.02869021443175247, 0.01988638665361045},
         {0.02337996692142284, 0.01462207933769694, -0.06194833926566719, 0.09866394857735718, -0.1674398614377765, 0.4333610512593997, 0.8108987587176578, -0.2074807212033782, 0.1163027618467162, -0.07804714082512956, 0.05534278599310258, -0.0376552899214013},
         {-0.02050781249999989, -0.02050781249999988, 0.05338924668599511, -0.08082637279563813, 0.1213558294955844, -0.2090335758180512, 0.6356226849321094, 0.6356226849321103, -0.2090335758180511, 0.1213558294955839, -0.08082637279563784, 0.05338924668599519},
         {0.0146220793376969, 0.02337996692142277, -0.03765528992140138, 0.05534278599310309, -0.07804714082512984, 0.1163027618467164, -0.2074807212033787, 0.8108987587176572, 0.4333610512594007, -0.1674398614377762, 0.09866394857735705, -0.06194833926566759},
         {-0.007776656272747096, -0.02042480902933806, 0.01988638665361041, -0.02869021443175286, 0.03901174614839015, -0.05409390997387797, 0.08148928976598388, -0.15283383038077, 0.9369122012492648, 0.2287954811644308, -0.09809592768203723, 0.05582024278884303},
         {0.00153505760883434, 0.007049059677191317, -0.00390719631258292, 0.005569534690765515, -0.007403946458944308, 0.009854158204943522, -0.0136989831235876, 0.02109577874451493, -0.0422820230188861, 0.9966763940054976, 0.04601024332640033, -0.02049807734414701},
         {0.002982105238146231, 0.02707612017826254, -0.007567162597406654, 0.01070278967253725, -0.01402650252535036, 0.01821548564483685, -0.02423782479325151, 0.0341915717224692, -0.05441845399828767, 0.1192658267404043, 0.9800276636899642, -0.09221161897232447},
         {-0.005093765865551346, -0.1185389261578716, 0.01290092552964289, -0.01815905056184314, 0.02359348151902554, -0.03020058412829484, 0.03921703520244045, -0.05292994029020795, 0.0767816522967598, -0.1284799245008374, 0.3207927813158059, 0.8801163156409322},
         {0.004467189386972027, 0.5603940157942702, -0.01130278088142801, 0.01586992081183782, -0.0205281690831581, 0.02608656506663651, -0.03347294055047843, 0.04425789989901337, -0.06173986945895095, 0.09449078476625083, -0.1735606863857843, 0.5550380706348196}};
#elif DEGREE == 12
    // Quadrature rules
    static constexpr S phi[14][13] =
        {{0.5515439363512676, -0.00380866123460504, 0.5651767944343855, -0.1754157350917028, 0.09540990382997275, -0.06236458530145036, 0.04478208048465969, -0.03400162875168516, 0.02671174745199817, -0.02136730608686322, 0.0171196066284133, -0.01339441170335393, 0.009608258988963593},
         {-0.1219748126264106, 0.004526542083256469, 0.8644719496011315, 0.3450488483707553, -0.1363808033789497, 0.08130449586937458, -0.05607424198253314, 0.04167811497109238, -0.03233591009732233, 0.02566572892332308, -0.02046158974485564, 0.01595921512392377, -0.01142753711278579},
         {0.03307151173515318, -0.003127577508486558, -0.1116328003652195, 0.9684916423741157, 0.153382165045911, -0.06887844709886849, 0.04314070543099602, -0.03062465754693455, 0.02316015465823335, -0.0181009555602064, 0.01429166222966986, -0.01108003651866092, 0.007906633124297201},
         {0.0009331201864810901, -0.0001729357731215068, -0.002702139905919942, 0.005952700545453493, 0.9999399802280116, -0.005924415813904391, 0.002906374350096247, -0.001882007874698652, 0.001359210696848412, -0.001034735560330319, 0.0008040658307705145, -0.0006173577049117251, 0.0004381407952254168},
         {-0.01550051263898403, 0.004958852599237121, 0.04225441661250427, -0.07363638144585023, 0.1663645874783568, 0.9641756415223873, -0.1232543504098129, 0.06464519155830187, -0.04287692917879676, 0.03123782373755613, -0.02367026507331707, 0.01790613616728871, -0.01260421092887062},
         {0.02039502561249476, -0.01052732200990057, -0.05394075205114732, 0.08546344965122631, -0.1431800968861897, 0.3518096256658844, 0.8676454483692591, -0.1929052461938529, 0.1065865568042381, -0.07185028175999243, 0.05228085921891083, -0.0386622802773745, 0.02688501385644443},
         {-0.01973196650105831, 0.01588353528263512, 0.05129352921395849, -0.07735084416129016, 0.1152177474099426, -0.1948320811112243, 0.5436653873014313, 0.7220242515113277, -0.2148724916360428, 0.1235839404202308, -0.08386754038849029, 0.05983592486607646, -0.04084939220749638},
         {0.01588353528263505, -0.01973196650105843, -0.04084939220749636, 0.05983592486607625, -0.0838675403884904, 0.1235839404202311, -0.2148724916360427, 0.7220242515113272, 0.5436653873014312, -0.1948320811112237, 0.1152177474099425, -0.07735084416129019, 0.05129352921395837},
         {-0.01052732200990057, 0.02039502561249488, 0.02688501385644446, -0.03866228027737469, 0.05228085921891103, -0.07185028175999279, 0.1065865568042381, -0.1929052461938535, 0.8676454483692586, 0.351809625665885, -0.1431800968861899, 0.08546344965122674, -0.0539407520511474},
         {0.004958852599237187, -0.01550051263898421, -0.01260421092887083, 0.01790613616728884, -0.02367026507331743, 0.03123782373755644, -0.04287692917879735, 0.06464519155830231, -0.123254350409814, 0.9641756415223874, 0.1663645874783579, -0.0736363814458513, 0.04225441661250461},
         {-0.0001729357731214097, 0.0009331201864802262, 0.0004381407952248756, -0.000617357704910837, 0.0008040658307696819, -0.001034735560329278, 0.001359210696846622, -0.001882007874696751, 0.002906374350093166, -0.005924415813898465, 0.9999399802280117, 0.005952700545447318, -0.00270213990591707},
         {-0.003127577508486502, 0.03307151173515285, 0.007906633124297159, -0.01108003651866082, 0.01429166222966947, -0.01810095556020608, 0.02316015465823294, -0.03062465754693411, 0.04314070543099517, -0.06887844709886708, 0.1533821650459095, 0.968491642374115, -0.1116328003652176},
         {0.004526542083256428, -0.121974812626412, -0.01142753711278598, 0.01595921512392381, -0.02046158974485575, 0.02566572892332335, -0.03233591009732169, 0.04167811497109267, -0.05607424198253333, 0.08130449586937481, -0.136380803378951, 0.3450488483707551, 0.8644719496011334},
         {-0.003808661234604993, 0.5515439363512687, 0.009608258988963503, -0.01339441170335397, 0.01711960662841292, -0.0213673060868631, 0.02671174745199881, -0.03400162875168494, 0.04478208048465959, -0.06236458530144993, 0.09540990382997204, -0.1754157350917027, 0.5651767944343842}};

#elif DEGREE == 13
    static constexpr S phi[15][14] =
        {{0.5438254885938764, 0.00328470791268054, 0.5739750928406647, -0.176963213158868, 0.09616440327714879, -0.06286712468404851, 0.04518964574497363, -0.03439268098174249, 0.02714668532689095, -0.02191259704792707, 0.01786985726935558, -0.01451398531325485, 0.0114611172384563, -0.008267397018205988},
         {-0.1245458871882781, -0.004032647650254399, 0.8501972639792584, 0.3662810004526613, -0.143048671770412, 0.08507960797050115, -0.0586760896817372, 0.04368888263585008, -0.03404122890209142, 0.0272546120244411, -0.02210792753151369, 0.01789285008464232, -0.01409714581493764, 0.01015538139187038},
         {0.03790311410573875, 0.003112987066022681, -0.1269971876908728, 0.9563996703292094, 0.1839752802109111, -0.08141175535650408, 0.05082642300992329, -0.03609051302123731, 0.02738484282479001, -0.02157293716396994, 0.01731817993981463, -0.01392149172627506, 0.01092078184454929, -0.007847394372099935},
         {-0.004226978212865298, -0.0006755209159637621, 0.01219799737040349, -0.02646231041570334, 0.998727329159251, 0.02822474224822895, -0.01362806418876192, 0.008794645599085826, -0.006360870885628464, 0.004874466316597215, -0.003846767643901308, 0.003058725007203514, -0.002382997878766231, 0.001705604440819984},
         {-0.0110507520951964, -0.003017927526094465, 0.0300607107023803, -0.05202549992674221, 0.114581720559509, 0.9818046325342066, -0.0927551254345936, 0.0478752808508036, -0.03166870978914032, 0.0231709259253124, -0.01779832510591518, 0.01391866189343794, -0.01073322095135339, 0.007637628363386086},
         {0.01729266729024897, 0.00751477894074748, -0.04566734851802608, 0.07204668094358477, -0.1194423603337571, 0.2818962229755986, 0.90970383589934, -0.1731272419645052, 0.09422076675557245, -0.06348922121915693, 0.04669117673402842, -0.03559991856007574, 0.02704134425109007, -0.01908138319468972},
         {-0.01829059711657395, -0.01216342727128313, 0.04749038832160885, -0.07139115793799521, 0.105660675158637, -0.1760492810547143, 0.4609871229629285, 0.7904177881852196, -0.2112476462278489, 0.1199509070422522, -0.08182609002765848, 0.05994697442067978, -0.044518296316594, 0.03103263986134169},
         {0.01611328125000009, 0.01611328125000005, -0.04139732081171996, 0.06047960321705059, -0.08436165461443235, 0.1232142737669566, -0.2099458793904549, 0.6358976965826013, 0.6358976965825995, -0.2099458793904562, 0.1232142737669571, -0.08436165461443264, 0.06047960321705069, -0.0413973208117199},
         {-0.012163427271283, -0.01829059711657348, 0.03103263986134126, -0.04451829631659332, 0.05994697442067877, -0.08182609002765687, 0.1199509070422495, -0.2112476462278451, 0.7904177881852192, 0.4609871229629258, -0.1760492810547126, 0.1056606751586361, -0.07139115793799432, 0.04749038832160812},
         {0.007514778940747563, 0.01729266729024891, -0.01908138319468965, 0.02704134425108998, -0.03559991856007559, 0.04669117673402826, -0.06348922121915675, 0.09422076675557246, -0.1731272419645067, 0.90970383589934, 0.2818962229756001, -0.1194423603337577, 0.07204668094358496, -0.04566734851802608},
         {-0.003017927526094463, -0.01105075209519624, 0.007637628363386051, -0.01073322095135328, 0.0139186618934376, -0.0177983251059148, 0.02317092592531214, -0.03166870978914028, 0.04787528085080323, -0.09275512543459308, 0.9818046325342066, 0.1145817205595083, -0.0520254999267418, 0.03006071070238007},
         {-0.0006755209159636615, -0.004226978212865232, 0.00170560444082006, -0.002382997878766294, 0.003058725007203625, -0.003846767643901419, 0.00487446631659734, -0.006360870885628561, 0.008794645599086076, -0.0136280641887621, 0.02822474224822946, 0.9987273291592508, -0.02646231041570378, 0.01219799737040383},
         {0.00311298706602264, 0.03790311410573829, -0.007847394372100018, 0.01092078184454923, -0.01392149172627488, 0.01731817993981438, -0.02157293716397007, 0.02738484282478992, -0.03609051302123716, 0.05082642300992293, -0.08141175535650402, 0.1839752802109102, 0.9563996703292107, -0.1269971876908725},
         {-0.004032647650254368, -0.1245458871882762, 0.01015538139187035, -0.01409714581493756, 0.01789285008464195, -0.02210792753151353, 0.02725461202444035, -0.03404122890209073, 0.04368888263584982, -0.05867608968173682, 0.08507960797049985, -0.1430486717704101, 0.3662810004526571, 0.8501972639792593},
         {0.003284707912680498, 0.5438254885938745, -0.008267397018205946, 0.01146111723845633, -0.01451398531325521, 0.01786985726935597, -0.02191259704792759, 0.02714668532689153, -0.03439268098174281, 0.04518964574497397, -0.06286712468404927, 0.09616440327715071, -0.1769632131588713, 0.5739750928406684}};
#elif DEGREE == 14
    // Quadrature rules
    static constexpr S phi[16][15] =
        {{0.537035932899943, -0.002861202417525868, 0.5816801466712337, -0.1782698064449126, 0.09679248090822856, -0.0632787881277968, 0.04551487443159825, -0.03469278012178788, 0.02746447140067365, -0.02228987977815178, 0.01835918812614942, -0.01519447315258724, 0.01247267319862249, -0.009921086866134715, 0.00718824927244666},
         {-0.126487807756159, 0.003605201004445115, 0.8371730959276203, 0.3849978676749962, -0.1487283493885226, 0.08826279779246374, -0.06085395885351115, 0.04535555673886295, -0.03543156938529118, 0.02851401088042164, -0.02335433144697931, 0.01925502104379373, -0.01576496937657947, 0.01251855902856683, -0.009061123884128344},
         {0.04183638338317099, -0.003013191741456415, -0.1392995017767624, 0.9442435244185284, 0.2114602540210622, -0.09231514190478962, 0.05745302955260863, -0.04078397290103222, 0.03100218636754971, -0.02453399977845008, 0.01987624622362757, -0.01626793277015227, 0.01325385294862735, -0.01049077082319418, 0.007579034780662429},
         {-0.008590847726781783, 0.00119703668992914, 0.02471802468456508, -0.05294066774020658, 0.9945621922600328, 0.06000830985944268, -0.02854674118187157, 0.01835632908289261, -0.01327937978900715, 0.01021195820399179, -0.008125972278978724, 0.006573099953886163, -0.005313729806993447, 0.004184868837553153, -0.003014481048454934},
         {-0.00708717975412914, 0.001673910321392528, 0.01924447681701176, -0.03311322327256352, 0.07142289245940744, 0.9924560910478795, -0.06244535953231053, 0.03174118049239771, -0.02092418963919813, 0.01533373686188603, -0.01185983638271543, 0.009423313675317381, -0.007530264054047033, 0.005887086405615187, -0.004222635445943743},
         {0.01426189084300486, -0.005301520307751834, -0.03761657776213023, 0.05913417630767803, -0.0971848322868899, 0.2221066278970681, 0.9404856731083009, -0.1502779387051237, 0.08056644930315879, -0.05415570791296409, 0.04000905943081216, -0.0309360346856993, 0.02430565937390286, -0.01880289994792126, 0.01340597534455484},
         {-0.01649954022548636, 0.009248734606389898, 0.04279840452173435, -0.06417177830053214, 0.09447468268446274, -0.155515822902787, 0.3877279603353007, 0.8440891386549955, -0.2009419224909999, 0.1125258462529076, -0.07676498260008491, 0.05686520697055642, -0.04356316322752575, 0.03319342268071374, -0.02346618695964436},
         {0.01565770990885149, -0.01294052028154728, -0.0401934788378947, 0.05859699643390255, -0.08141710121816502, 0.1180589482611158, -0.1979092276248326, 0.5555090230994294, 0.7119716291987708, -0.2153929832568142, 0.1249766886950026, -0.0860680017818285, 0.06339647687270679, -0.04723595442613712, 0.03298979495744044},
         {-0.01294052028154725, 0.01565770990885161, 0.03298979495744049, -0.04723595442613737, 0.06339647687270664, -0.08606800178182854, 0.1249766886950029, -0.2153929832568141, 0.7119716291987702, 0.5555090230994302, -0.197909227624833, 0.1180589482611158, -0.08141710121816477, 0.05859699643390202, -0.04019347883789461},
         {0.009248734606389836, -0.01649954022548647, -0.02346618695964443, 0.03319342268071396, -0.04356316322752575, 0.05686520697055632, -0.0767649826000848, 0.1125258462529074, -0.2009419224909997, 0.8440891386549949, 0.3877279603353007, -0.1555158229027866, 0.09447468268446231, -0.06417177830053172, 0.04279840452173427},
         {-0.005301520307751879, 0.01426189084300509, 0.01340597534455499, -0.01880289994792157, 0.02430565937390314, -0.03093603468569956, 0.04000905943081241, -0.05415570791296442, 0.08056644930315947, -0.1502779387051252, 0.9404856731083007, 0.2221066278970699, -0.09718483228689057, 0.05913417630767825, -0.03761657776213056},
         {0.001673910321392521, -0.007087179754129046, -0.004222635445943645, 0.00588708640561534, -0.007530264054046783, 0.009423313675317332, -0.01185983638271561, 0.01533373686188592, -0.02092418963919791, 0.03174118049239771, -0.06244535953230974, 0.992456091047879, 0.071422892459407, -0.03311322327256312, 0.01924447681701161},
         {0.00119703668992914, -0.008590847726781758, -0.003014481048454913, 0.004184868837553375, -0.005313729806993434, 0.006573099953886136, -0.008125972278978558, 0.01021195820399164, -0.01327937978900715, 0.0183563290828927, -0.02854674118187152, 0.06000830985944268, 0.9945621922600322, -0.05294066774020577, 0.024718024684565},
         {-0.003013191741456311, 0.0418363833831714, 0.007579034780662554, -0.01049077082319459, 0.01325385294862748, -0.01626793277015236, 0.01987624622362746, -0.02453399977845025, 0.03100218636754974, -0.04078397290103269, 0.05745302955260913, -0.09231514190479032, 0.2114602540210623, 0.9442435244185282, -0.1392995017767627},
         {0.003605201004445217, -0.1264878077561611, -0.009061123884128261, 0.01251855902856711, -0.01576496937657954, 0.01925502104379394, -0.02335433144697989, 0.02851401088042178, -0.03543156938529143, 0.04535555673886403, -0.06085395885351137, 0.08826279779246432, -0.1487283493885231, 0.3849978676749968, 0.8371730959276218},
         {-0.002861202417525908, 0.5370359328999416, 0.007188249272446476, -0.009921086866134549, 0.01247267319862249, -0.01519447315258684, 0.01835918812614949, -0.02228987977815174, 0.0274644714006736, -0.03469278012178736, 0.04551487443159784, -0.06327878812779625, 0.09679248090822702, -0.1782698064449103, 0.5816801466712335}};
#elif DEGREE == 15
    // Quadrature rules
    static constexpr S phi[17][16] =
        {{0.5310179651539464, 0.002514143263163935, 0.5884823047483401, -0.1793847948263926, 0.09732164084031419, -0.06362108595724811, 0.04577976819603172, -0.03492972494947332, 0.02770554332857516, -0.02256350657595143, 0.0186976301468647, -0.01564139383462303, 0.01309572661657697, -0.01084094025003896, 0.008673660364852936, -0.006306936264939254},
         {-0.1279643740930913, -0.003235687285707379, 0.8252760195271448, 0.4016052578050366, -0.1536075508159038, 0.09097174773002764, -0.06269562416475229, 0.04675394028868567, -0.03658362653399428, 0.02953633333506205, -0.02433380644796818, 0.02027471838678174, -0.0169273774697442, 0.01398560334933904, -0.01117514119019878, 0.008119567579282769},
         {0.04506847775101077, 0.002870613041430817, -0.1492565638184746, 0.9323133249205202, 0.23621934001387, -0.1018419901991911, 0.06319363895274985, -0.04483303014671647, 0.03411303384957227, -0.02707010731090421, 0.02205080070300107, -0.01823148475814151, 0.01514049433573553, -0.01246336839301157, 0.009934557924711498, -0.007207736866162349},
         {-0.0122955403612308, -0.001507932790634482, 0.03528793100807331, -0.07476331401308442, 0.9884767900729201, 0.08944352429381386, -0.04196240826589002, 0.02688770122719899, -0.01944302869602268, 0.01497995718889016, -0.01197709268493108, 0.009780881755745124, -0.008054536715507498, 0.006592445566052041, -0.005235056128685022, 0.003789678543292378},
         {-0.003582234564907973, -0.0007397741097204544, 0.009712345260434109, -0.01662921035517726, 0.03524923230686692, 0.9980461370946736, -0.03297846445881437, 0.01652159743212375, -0.01085112819950874, 0.007953873646228035, -0.006174506294947072, 0.004948273372891787, -0.004024346742651454, 0.003266432998359412, -0.002579816169174132, 0.001861588783323409},
         {0.01139891269024138, 0.003672131136338279, -0.03003351311013625, 0.04707080384154302, -0.07679234987354021, 0.1709490109412137, 0.9626287483056378, -0.1258109160332869, 0.0664757424471302, -0.04453582436867205, 0.03295929578191512, -0.02566796309725891, 0.02049754424751994, -0.01644016709043104, 0.01288579309629185, -0.009257248914506192},
         {-0.01455857691406363, -0.006990023863127169, 0.03773300702719305, -0.05645426657445452, 0.08274433532555148, -0.1348356252830772, 0.3233027662258359, 0.8858877501707697, -0.1860605036384322, 0.1027438196202607, -0.06994074440908239, 0.0520609265908756, -0.04046019944613813, 0.03190210201316646, -0.02473958412712688, 0.01766481728184918},
         {0.01476942609043255, 0.01029569794319784, -0.03788738811311263, 0.05513904599848165, -0.07636531428674283, 0.1100722191402693, -0.182057295399816, 0.4820557925418175, 0.7741419307270466, -0.2134701215720277, 0.1222953984338137, -0.08426281753752021, 0.06278183258882568, -0.04827648106171864, 0.03687498906184552, -0.02610691455479219},
         {-0.01309204101562497, -0.01309204101562476, 0.03335544248995567, -0.04768643702639117, 0.06383014874598097, -0.08627598963282548, 0.1243076624552216, -0.2105115081265028, 0.6360727221101866, 0.6360727221101856, -0.2105115081265032, 0.1243076624552222, -0.08627598963282605, 0.06383014874598135, -0.04768643702639119, 0.0333554424899555},
         {0.01029569794319802, 0.01476942609043224, -0.02610691455479228, 0.03687498906184563, -0.04827648106171811, 0.06278183258882485, -0.08426281753751948, 0.122295398433813, -0.2134701215720272, 0.7741419307270481, 0.4820557925418161, -0.1820572953998165, 0.1100722191402696, -0.07636531428674294, 0.05513904599848175, -0.03788738811311233},
         {-0.006990023863127214, -0.01455857691406326, 0.01766481728184916, -0.02473958412712671, 0.03190210201316591, -0.04046019944613732, 0.05206092659087483, -0.06994074440908155, 0.1027438196202596, -0.1860605036384305, 0.8858877501707692, 0.3233027662258352, -0.1348356252830767, 0.08274433532555145, -0.05645426657445405, 0.03773300702719245},
         {0.003672131136338372, 0.01139891269024119, -0.009257248914506213, 0.01288579309629184, -0.01644016709043108, 0.0204975442475199, -0.02566796309725889, 0.03295929578191521, -0.04453582436867198, 0.06647574244713061, -0.1258109160332882, 0.9626287483056382, 0.1709490109412155, -0.0767923498735413, 0.04707080384154315, -0.03003351311013618},
         {-0.0007397741097203759, -0.003582234564907631, 0.001861588783323304, -0.002579816169174019, 0.003266432998359116, -0.00402434674265136, 0.004948273372891495, -0.006174506294946129, 0.007953873646227618, -0.01085112819950805, 0.01652159743212246, -0.0329784644588121, 0.9980461370946738, 0.03524923230686489, -0.01662921035517622, 0.00971234526043321},
         {-0.001507932790634488, -0.01229554036123014, 0.003789678543292209, -0.005235056128684671, 0.00659244556605205, -0.00805453671550704, 0.009780881755744731, -0.01197709268493109, 0.01497995718888948, -0.01944302869602188, 0.02688770122719853, -0.04196240826588903, 0.08944352429381204, 0.9884767900729191, -0.07476331401308196, 0.03528793100807208},
         {0.002870613041430897, 0.04506847775100948, -0.007207736866162166, 0.009934557924711492, -0.01246336839301133, 0.0151404943357351, -0.01823148475814128, 0.02205080070300086, -0.02707010731090405, 0.03411303384957202, -0.04483303014671617, 0.06319363895274926, -0.1018419901991907, 0.2362193400138681, 0.932313324920521, -0.1492565638184725},
         {-0.003235687285707462, -0.1279643740930884, 0.008119567579282807, -0.01117514119019882, 0.01398560334933864, -0.01692737746974373, 0.02027471838678136, -0.02433380644796824, 0.02953633333506196, -0.03658362653399378, 0.04675394028868562, -0.06269562416475218, 0.09097174773002788, -0.1536075508159031, 0.4016052578050306, 0.8252760195271468},
         {0.002514143263164026, 0.5310179651539493, -0.006306936264939346, 0.008673660364852944, -0.01084094025003944, 0.01309572661657747, -0.0156413938346234, 0.01869763014686555, -0.02256350657595169, 0.02770554332857545, -0.03492972494947431, 0.04577976819603254, -0.06362108595724961, 0.09732164084031682, -0.1793847948263956, 0.5884823047483394}};
#endif
};